---
description: 
globs: 
alwaysApply: true
---
# Build and Deployment Workflow Rule

Always perform the following steps on any code changes before pushing to the `main` branch:

1. **Clear Cache**  
   Remove the Next.js build cache by deleting the `.next` directory:  
   ```bash
   rm -rf .next
   ```

2. **Internal Build**  
   Ensure the application compiles without errors:  
   ```bash
   npm run build
   ```

3. **Lint & Import Sorting**  
   Run ESLint and auto–fix imports:  
   ```bash
   npm run lint
   npm run lint -- --fix
   ```  
   Then (optionally) run Biome to catch any additional style issues:  
   ```bash
   npx biome check app components lib hooks
   ```

4. **Unit & Integration Tests**  
   Run Vitest to validate all unit and integration tests pass:  
   ```bash
   npm test
   ```  
   (Optionally, include coverage reports: `npx vitest run --coverage`.)

5. **E2E / Smoke Tests**  
   Run your end-to-end and smoke tests (Playwright):  
   ```bash
   npx playwright test
   ```

6. **Internal Deployment**  
   Deploy to a staging environment to validate runtime behavior:  
   ```bash
   npm run deploy
   ```
   – Manually browse key pages (home, landing, resource) to confirm nothing is broken.

After **every** build, lint, and test step passes with **zero errors**, **zero warnings**, and **all tests green**:

7. **Git Push**  
   Commit any final changes and push to the `main` branch.  

8. **Auto-Deployment to Vercel**  
   Pushing to `main` will trigger your Vercel workflow and deploy to production.

_Do not skip any step in this workflow—ensuring a fully functional, bug-free codebase is mandatory before going live._  

## ESLint `simple-import-sort` Rule (Date: 2025-04-28)

- **Issue:** Builds were failing due to unsorted imports (`simple-import-sort/imports` & `simple-import-sort/exports`).  
- **Resolution:** Always run ESLint with `--fix` to apply the project’s configured sort order reliably.  
- **Workflow Reminder:** After adding or updating imports/exports (e.g. when scaffolding new pages or sections), be sure to re-run:  
  ```bash
  npm run lint -- --fix
  ```

And to run a ligthouse check use "npm run lhci" and "npm run lhci:prod" for live url real results